<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Development process" href="../develop/index.html" /><link rel="prev" title="Basic usage" href="basic.html" />
        <link rel="canonical" href="https://glasgow-embedded.org/latest/use/repl-script.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>REPL &amp; script operation - Glasgow Interface Explorer</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=5f2c338f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-announcement-background: #ffdf76;
  --color-announcement-text: #664e04;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: #604b2b;
  --color-announcement-text: #eee388;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: #604b2b;
  --color-announcement-text: #eee388;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     This documentation page has been built as a preview. It may be outdated or incorrect compared to <a href='https://glasgow-embedded.org/'>the official version</a>. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Glasgow Interface Explorer</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Glasgow Interface Explorer</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../revisions/index.html">Hardware revisions</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hardware revisions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../revisions/revC3.html">Technical description (revC3)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../purchase.html">Purchasing hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Building hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing &amp; updating</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Using the device</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Using the device</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic.html">Basic usage</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">REPL &amp; script operation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../develop/index.html">Development process</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Development process</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../develop/applet.html">Applets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/software.html">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/firmware.html">Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/hardware.html">Hardware</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/GlasgowEmbedded/glasgow/edit/main/docs/manual/src/use/repl-script.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="repl-script-operation">
<span id="repl-script"></span><h1>REPL &amp; script operation<a class="headerlink" href="#repl-script-operation" title="Permalink to this heading">#</a></h1>
<section id="what-is-repl">
<h2>What is “<em>REPL</em>”?<a class="headerlink" href="#what-is-repl" title="Permalink to this heading">#</a></h2>
<p>If you’ve ever typed <code class="docutils literal notranslate"><span class="pre">python3</span></code> into a terminal, or found yourself looking at the three angle brackets (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code>), then you’ll have some idea of what we’re referring to. It stands for “<cite>Read Eval Print Loop</cite>”, and is a fundamental way of interacting with many interpreted languages (including Bash and JavaScript, alongside Python).</p>
<p>By invoking <code class="docutils literal notranslate"><span class="pre">glasgow</span> <span class="pre">repl</span> <span class="pre">...</span></code> you can gain interactive code-level access to the applet of your choice.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As always, please make sure you select the correct I/O and supply voltage for whatever you have connected to your Glasgow.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>glasgow<span class="w"> </span>repl<span class="w"> </span>i2c-initiator<span class="w"> </span>-V<span class="w"> </span><span class="m">3</span>.3<span class="w"> </span>--pulls
<span class="go">I: g.device.hardware: generating bitstream ID f030465844b160e664799138b54ee2c7</span>
<span class="go">I: g.cli: running handler for applet &#39;i2c-initiator&#39;</span>
<span class="go">I: g.applet.interface.i2c_initiator: port(s) A, B voltage set to 3.3 V</span>
<span class="go">I: g.applet.interface.i2c_initiator: dropping to REPL; use &#39;help(iface)&#39; to see available APIs</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>What happens now is entirely up to you — <code class="docutils literal notranslate"><span class="pre">glasgow</span> <span class="pre">script</span> <span class="pre">...</span></code> is given an identical environment, except that it will run the nominated script rather than present control to you.</p>
<p>The Glasgow framework provides us with access to the <code class="docutils literal notranslate"><span class="pre">device</span></code>, <code class="docutils literal notranslate"><span class="pre">iface</span></code> and <code class="docutils literal notranslate"><span class="pre">args</span></code> variables.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; locals().keys()</span>
<span class="go">dict_keys([&#39;__name__&#39;, &#39;device&#39;, &#39;iface&#39;, &#39;args&#39;, &#39;__builtins__&#39;])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some examples are maintained in the <a class="reference external" href="https://github.com/GlasgowEmbedded/glasgow/tree/main/examples">examples</a> directory.</p>
</div>
<p>One further note — a lot of the Glasgow framework uses <code class="docutils literal notranslate"><span class="pre">asyncio</span></code>, with the most apparent impact to users being that the <code class="docutils literal notranslate"><span class="pre">await</span></code> keyword must be used. You are provided with an async-capable environment, so no additional setup work is required on your part — just use the <code class="docutils literal notranslate"><span class="pre">await</span></code> keyword… if you ever see a <code class="docutils literal notranslate"><span class="pre">&lt;coroutine</span> <span class="pre">object</span> <span class="pre">....&gt;</span></code>, try using <code class="docutils literal notranslate"><span class="pre">await</span></code>.</p>
</section>
<section id="how-do-i-use-this-interface">
<h2>How do I use this interface?<a class="headerlink" href="#how-do-i-use-this-interface" title="Permalink to this heading">#</a></h2>
<p>The exact usage will depend heavily on the applet you’ve requested, some examples are provided below with explanations.</p>
<p>As the startup prompt suggests, investigating <code class="docutils literal notranslate"><span class="pre">help(iface)</span></code> and <code class="docutils literal notranslate"><span class="pre">help(device)</span></code> are good places to start… after that, have a look at the applet’s code.</p>
<section id="i2c">
<h3>I²C<a class="headerlink" href="#i2c" title="Permalink to this heading">#</a></h3>
<p>For this example, I will be using the <a class="reference external" href="https://www.sparkfun.com/products/retired/9694">Sparkfun BMP085</a> (a now-retired breakout for an I²C barometric pressure sensor), which supports 3.3v operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I²C busses are implemented using open-drain, meaning that pull-up resistors are <cite>required</cite>… Glasgow’s onboard 10kΩ pull-ups can be enabled by passing the <code class="docutils literal notranslate"><span class="pre">--pulls</span></code> argument — while they will generally be enough, they may not suffice for fast or long busses. This particular breakout board has on-board pull-ups already, so it’s not necessary to use them.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>glasgow<span class="w"> </span>repl<span class="w"> </span>i2c-initiator<span class="w"> </span>-V<span class="w"> </span><span class="m">3</span>.3
<span class="go">I: g.device.hardware: device already has bitstream ID f030465844b160e664799138b54ee2c7</span>
<span class="go">I: g.cli: running handler for applet &#39;i2c-initiator&#39;</span>
<span class="go">I: g.applet.interface.i2c_initiator: port(s) A, B voltage set to 3.3 V</span>
<span class="go">I: g.applet.interface.i2c_initiator: dropping to REPL; use &#39;help(iface)&#39; to see available APIs</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Let’s start with a bus scan:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; await iface.scan()</span>
<span class="go">{119}</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Address <code class="docutils literal notranslate"><span class="pre">119</span></code> has responded, which is <code class="docutils literal notranslate"><span class="pre">0x77</span></code> — and this matches the datasheet!</p>
<p>This sensor isn’t the easiest to operate directly (you need to read a number of calibration variables and perform long calculations), so this is a great example of when you might want to start writing a script instead of using the REPL interface… however, to prove the point, we’re going to read a register and leave the rest as an exercise for the reader.</p>
<p>If you’re familiar with I²C, you’ll know that a common convention is for the target register address to be conveyed as the first portion of a write’s payload, with a subsequent read accessing the data from that location, with addresses incrementing automatically. Here we read the <code class="docutils literal notranslate"><span class="pre">AC1</span></code> value, which is a 16-bit integer stored at addresses <code class="docutils literal notranslate"><span class="pre">0xAA</span></code> and <code class="docutils literal notranslate"><span class="pre">0xAB</span></code> — first by writing the <code class="docutils literal notranslate"><span class="pre">0xAA</span></code> base address, and then performing a 2-byte read.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; await iface.write(119, [ 0xAA ])</span>
<span class="go">True</span>
<span class="go">&gt;&gt;&gt; await iface.read(119, 2)</span>
<span class="go">&lt;memory at 0x7fda35b22200&gt;</span>
<span class="go">&gt;&gt;&gt; _.hex()</span>
<span class="go">&#39;1c04&#39;</span>
</pre></div>
</div>
<p>Note here, that the read operation returned a memory view, perhaps not what was expected… we can still access the result without repeating the operation by using Python’s <code class="docutils literal notranslate"><span class="pre">_</span></code> variable (<a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#reserved-classes-of-identifiers">ref</a>). If we were to only re-issue the <code class="docutils literal notranslate"><span class="pre">iface.read()</span></code>, then we would retrieve the contents of registers <code class="docutils literal notranslate"><span class="pre">0xAC</span></code> and <code class="docutils literal notranslate"><span class="pre">0xAD</span></code> (i.e: perhaps not what was expected).</p>
</section>
<section id="uart">
<h3>UART<a class="headerlink" href="#uart" title="Permalink to this heading">#</a></h3>
<p>To demonstrate a simple UART loopback, I’ve connected pin 0 and 1 of Port A together… i.e: anything that we transmit, will be immediately received again by us.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>glasgow<span class="w"> </span>repl<span class="w"> </span>uart<span class="w"> </span>-V<span class="w"> </span><span class="m">3</span>.3
<span class="go">I: g.device.hardware: device already has bitstream ID 067aee2e95ca0facf53eddbf5b092d50</span>
<span class="go">I: g.cli: running handler for applet &#39;uart&#39;</span>
<span class="go">I: g.applet.interface.uart: port(s) A, B voltage set to 3.3 V</span>
<span class="go">I: g.applet.interface.uart: dropping to REPL; use &#39;help(iface)&#39; to see available APIs</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Again, we simply call the <code class="docutils literal notranslate"><span class="pre">iface.write()</span></code> and <code class="docutils literal notranslate"><span class="pre">iface.read()</span></code> functions to handle transmit and receive…</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; await iface.write(b&#39;hello!&#39;)</span>
<span class="go">&gt;&gt;&gt; await iface.read()</span>
<span class="go">&lt;memory at 0x7f54c959a680&gt;</span>
<span class="go">&gt;&gt;&gt; bytes(_)</span>
<span class="go">b&#39;hello!&#39;</span>
</pre></div>
</div>
<p>The UART applet also keeps track of some statistics for us:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; iface.statistics()</span>
<span class="go">I: g.applet.interface.uart: FIFO statistics:</span>
<span class="go">I: g.applet.interface.uart:   read total    : 6 B</span>
<span class="go">I: g.applet.interface.uart:   written total : 6 B</span>
<span class="go">I: g.applet.interface.uart:   reads waited  : 0.000 s</span>
<span class="go">I: g.applet.interface.uart:   writes waited : 0.002 s</span>
<span class="go">I: g.applet.interface.uart:   read stalls   : 0</span>
<span class="go">I: g.applet.interface.uart:   write stalls  : 1</span>
<span class="go">I: g.applet.interface.uart:   read wakeups  : 0</span>
<span class="go">I: g.applet.interface.uart:   write wakeups : 1</span>
</pre></div>
</div>
</section>
<section id="ws2812">
<h3>WS2812<a class="headerlink" href="#ws2812" title="Permalink to this heading">#</a></h3>
<p>I’ve got a <a class="reference external" href="https://www.adafruit.com/product/1768">quater of an Adafruit 60 LED ring</a>… that’s 15x WS2812 RGB LEDs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to some buffering artifacts, make sure you write a whole frame at once!</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>glasgow<span class="w"> </span>repl<span class="w"> </span>video-ws2812-output<span class="w"> </span>-V<span class="w"> </span><span class="m">5</span><span class="w"> </span>-c<span class="w"> </span><span class="m">15</span><span class="w"> </span>-b<span class="w"> </span><span class="m">1</span><span class="w"> </span>-f<span class="w"> </span>RGB-xBRG<span class="w"> </span>--pins-out<span class="w"> </span><span class="m">0</span>
<span class="go">I: g.device.hardware: device already has bitstream ID d8987a037e451abe4ffa1b6f76fd1116</span>
<span class="go">I: g.cli: running handler for applet &#39;video-ws2812-output&#39;</span>
<span class="go">I: g.applet.video.ws2812_output: port(s) A, B voltage set to 5.0 V</span>
<span class="go">I: g.applet.video.ws2812_output: dropping to REPL; use &#39;help(iface)&#39; to see available APIs</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Next, we just write pixel data! Glasgow handles the pixel format mapping for us, and because we requested <code class="docutils literal notranslate"><span class="pre">RGB-xBRG</span></code>, the conversion from RGB24 (three bytes per pixel) will be handled in hardware.
The <code class="docutils literal notranslate"><span class="pre">xBRG</span></code> indicates that we’re giving a constand <code class="docutils literal notranslate"><span class="pre">0</span></code> for the White channel, followed by the required order of Red, Green, and Blue.</p>
<p>They’re bright, so be careful of your eyes (I used <code class="docutils literal notranslate"><span class="pre">1</span></code> for a reason)… here’s a strip of green pixels:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; await iface.write([ 0,1,0 ] * args.count)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>A 3-bit rainbow: (black, red, green, yellow, blue, magenta, cyan, white)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; from itertools import chain</span>
<span class="go">&gt;&gt;&gt; pix = ( (n&amp;1, n&amp;2, n&amp;4) for n in range(args.count) )    # counter to 3-bit colors</span>
<span class="go">&gt;&gt;&gt; pix = chain.from_iterable(pix)                          # flatten to 1 dimension</span>
<span class="go">&gt;&gt;&gt; pix = map(lambda v: 1 if v else 0, pix)                 # flatten to 0 or 1</span>
<span class="go">&gt;&gt;&gt; pix = [ *pix ]                                          # make into a list for re-use</span>
<span class="go">&gt;&gt;&gt; await iface.write(pix)                                  # display it</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>And all off again, followed by a full power-down of the I/O:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; await iface.write([ 0,0,0 ] * args.count)</span>
<span class="go">&gt;&gt;&gt; await device.set_voltage(&#39;AB&#39;, 0)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Hopefully this example starts to show you the power you have available.</p>
</section>
</section>
<section id="how-do-i-use-a-script">
<span id="script-usage"></span><h2>How do I use a script?<a class="headerlink" href="#how-do-i-use-a-script" title="Permalink to this heading">#</a></h2>
<p>Scripts operate in exactly the same way as the REPL interface — the only real difference is that instead of you typing (or copy/pasting) the code, it will be read from the nominated file.
This allows you to build up much more sophisticated things, harnessing the power of Glasgow without touching any applet code directly.</p>
<p>See the <a class="reference external" href="https://github.com/GlasgowEmbedded/glasgow/blob/main/examples/i2c-pcf8574.py">PCF8574</a> example for a simple demo.</p>
</section>
<section id="can-i-use-command-line-arguments">
<h2>Can I use command line arguments?<a class="headerlink" href="#can-i-use-command-line-arguments" title="Permalink to this heading">#</a></h2>
<p>Yes! The <code class="docutils literal notranslate"><span class="pre">args</span></code> variable that is passed into the REPL and script environments contains all command line arguments that Glasgow sets up (including any defaults), along with a <code class="docutils literal notranslate"><span class="pre">script_args</span></code> member which contains anything after the first terminating <code class="docutils literal notranslate"><span class="pre">--</span></code>.</p>
<p>Of course you’re also able to setup <code class="docutils literal notranslate"><span class="pre">argparse</span></code> or do whatever argument parsing you need to do — see the <a class="reference external" href="https://github.com/GlasgowEmbedded/glasgow/blob/main/examples/script_args.py">script args</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>glasgow<span class="w"> </span>repl<span class="w"> </span>i2c-initiator<span class="w"> </span>-V<span class="w"> </span><span class="m">3</span>.3<span class="w"> </span>--pulls<span class="w"> </span>--<span class="w"> </span><span class="nb">test</span><span class="w"> </span>me
<span class="go">I: g.device.hardware: device already has bitstream ID f030465844b160e664799138b54ee2c7</span>
<span class="go">I: g.cli: running handler for applet &#39;i2c-initiator&#39;</span>
<span class="go">I: g.applet.interface.i2c_initiator: port(s) A, B voltage set to 3.3 V</span>
<span class="go">I: g.applet.interface.i2c_initiator: dropping to REPL; use &#39;help(iface)&#39; to see available APIs</span>
<span class="go">&gt;&gt;&gt; args</span>
<span class="go">Namespace(verbose=0, quiet=0, log_file=None, filter_log=None, show_statistics=False, serial=None, action=&#39;repl&#39;, override_required_revision=False, reload=False, prebuilt=False, bitstream=None, trace=None, applet=&#39;i2c-initiator&#39;, port_spec=&#39;AB&#39;, pin_scl=0, pin_sda=1, bit_rate=100, voltage=3.3, mirror_voltage=False, keep_voltage=False, pulls=True, script_args=[&#39;test&#39;, &#39;me&#39;])</span>
<span class="go">&gt;&gt;&gt; args.script_args</span>
<span class="go">[&#39;test&#39;, &#39;me&#39;]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../develop/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Development process</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="basic.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Basic usage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020—2024, Glasgow Interface Explorer contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-solid fa-github fa-2x" href="https://github.com/GlasgowEmbedded/glasgow/" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">REPL &amp; script operation</a><ul>
<li><a class="reference internal" href="#what-is-repl">What is “<em>REPL</em>”?</a></li>
<li><a class="reference internal" href="#how-do-i-use-this-interface">How do I use this interface?</a><ul>
<li><a class="reference internal" href="#i2c">I²C</a></li>
<li><a class="reference internal" href="#uart">UART</a></li>
<li><a class="reference internal" href="#ws2812">WS2812</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-do-i-use-a-script">How do I use a script?</a></li>
<li><a class="reference internal" href="#can-i-use-command-line-arguments">Can I use command line arguments?</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=50ba5bf0"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    </body>
</html>